# Yaklass TOP fetcher

## Description

Скрипт чтобы забирать рейтинг учеников со страницы ТОП в ЯКласс.

Выгрузка сохраняется в CSV-файле. Последующие запуски будут обновлять файл инкрементарными апдейтами.

## Why

Ну, возможно, вы зачем-то захотите собирать статистику по прогрессу всего класса, 
где учится ваш ребёнок.

Лично мне это нужно, чтобы устраивать марафоны с вознаграждением. Хочу чтобы 
у детей была дополнительная мотивация на закрепление пройденного материала. 
Ведь повторение - мать учения, как изввестно. 

Хотите об этом поговорить? Пишите, обсудим: aneganov@gmail.com. 
 

## Prerequisites

Чтобы использовать этот софт, установите [Composer](https://getcomposer.org/).

## Setup

Установить пакет и его зависимости:

```
$ composer init --no-interaction -s dev --repository '{"type": "git", "url": "git@github.com:OnkelTem/yaklass_top.git"}'
$ composer require onkeltem/yaklass_top
```

Установите сервер [Selenium](http://selenium-release.storage.googleapis.com/index.html) 
и [Chromedriver](https://sites.google.com/a/chromium.org/chromedriver/downloads) либо вручную, 
либо запустив прилагающийся скрипт: 

```
$ vendor/bin/install.sh
```

В корне создайте файл `credentials.json` с вашими логином и паролем:

```json
{
  "username": "parent@example.com",
  "password": "parentPassword"
}
```

Нужно настроить хотя бы одного ребенка, чтобы получить доступ к странице с рейтингом. 

## Usage

Запустите сервер Selenium:

```
$ vendor/bin/start.sh
```

Запустите скрипт:

```
$ vendor/bin/yaklass_top
```

Он создает CSV-файл с именем `stats.csv` и следующей структурой:

| id | first_name | last_name | 2019-11-08 01:40:12 |
|----|------------|-----------|--------------------:|
| 749c2b76-1a... | Vladimir | Putin | 125 | 
| 213b1a32-b5... | George | Bush | 76 | 
| ... | 

The last column contains user's points and its name is
Последняя колонка содержит рейтинг пользователя, а название колонки - текущую дату.

Каждый раз, когда вы запскаете скрипт снова, он добавляет новую колонку
с кол-вом очков, набраных с момента предыдущего запуска скрипта:

| id | first_name | last_name | 2019-11-08 01:40:12 | 2019-11-08 01:40:12 |
|----|------------|-----------|--------------------:|--------------------:|
| 749c2b76-1a... | Vladimir | Putin | 125 | 12 |
| 213b1a32-b5... | George | Bush | 76 | 18 |
| ... | 

Таким образом, общее кол-во очков получается суммированием значений в строке. 
